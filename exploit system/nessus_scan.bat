@echo off
title Deep Red Framework v0.1
echo Retrieving arp information on local network...
arp -a
set /P ip= Enter ip or type 'scan' to scan using shodan API:  
set /P shodan= Enter shodan search query (e.g. heartbleed):  
IF "%ip%" == "scan" (
	ipython "%~dp0\shodan_integration.py" -- %shodan% > hosts.txt
	echo global IP's returned from query:
	type "%~dp0"\hosts.txt"
) ELSE (
	echo %ip% > hosts.txt
	ipython "%~dp0\nessus-scan.py" -- --target %ip% --policy testPolicy --name 'demo' --insecure
	echo Nessus scan UUID: 
	type "%~dp0\scanUUID.txt" + "\n"
	ipython "%~dp0\nessus_report_exporter.py" -- < "%~dp0\scanUUID.txt")
REM for csv export use this instead ->
REM	ipython "%~dp0\nessus_report_exporter_csv.py" -- < "%~dp0\scanUUID.txt")

echo scan complete, exporting to metasploit...
REM metasploit needs to run msgrpc before connection attempt.
REM Runs ssh tester module.
ipython "%~dp0\metasploit_integration.py"
REM metasploit on windows ROCKSTEAD has be automatically set to connect to postgresql on launch. check setup.rc
echo End
pause